\section{Numerical procedure} %Aleksandr's section

\addQ{Have you used any literature in developing this procedure? If so, let's cite it. }

Here we described the numerical method used to solve the %one-dimensional 
hydrodynamic transport equations for the quantities of interest---the particle density $n(x,t)$ and the momentum density $p(x,t)=mnu$---which read:
%The partial differential equation (PDE) system solved is as follows:
\begin{align}
\partial_t n &= -\partial_x p + D_n \partial_{x}^2 n, \label{eq:n_eq} \\[6pt]
\partial_t p &= -\gamma(n) p 
- \partial_x \left( \frac{1}{2} U n^2 + \frac{p^2}{m n} \right) %\notag \\
%&\quad 
+ e n \addQ{E_{\mathrm{eff}}(t) }
+ D_p \partial_{x}^2 p, \label{eq:p_eq}
\end{align}
where $\xi=(x,t)$. 
We non-dimensionalize the problem by setting $m=e=1$ and, in this paper, work with $n(\xi)$ and $p(\xi)$ defined on a finite interval $0<x<L$, obeying Eqs.\eqref{eq:n_eq} and \eqref{eq:p_eq} with periodic boundary conditions, $n(\xi)_{x=0}=n(\xi)_{x=L}$, $p(\xi)_{x=0}=p(\xi)_{x=L}$.
%We solve numerically the one-dimensional hydrodynamic system \eqref{eq:n_eq}-\eqref{eq:p_eq} on a periodic interval $x\in[0,L)$. 

The results shown in Fig. 2 and Fig. 3 have been produced by the numerical procedure summarized below.
The quantities of interest are the density $n(x,t)$ and the momentum density $p(x,t)=mnu$.
%Periodic boundary conditions are imposed at $x=0$ and $x=L$.
We use a mesh in both $x$ and $t$. 
Spatial derivatives are calculated in Fourier space for maximal accuracy, whereas the time evolution is \addQ{advanced} using a stiff, adaptive-step Backward Differentiation Formula (BDF) integrator.
Throughout, divisions by $n$ are regularized with $n_{\min}=10^{-7}$ in denominators; this has no discernible effect on converged solutions but avoids numerical singularities.

%All fields 
%Both $n(x)$ and $p(x)$ were represented by discrete Fourier series on an equispaced grid of $N_x$ points. 
The functions $n(x)$ and $p(x)$ were represented as discrete Fourier series evaluated on an equispaced grid of 
$N_x$ points.
\addQ{Increasing $N_x$ %discretization time causing 
results in a linear growth of the run-time, %. At the same time, 
we thus aimed} to maintain a resolution of at least 30â€“50 grid points per full oscillation of $n(x)$ and $p(x)$.

For improved numerical accuracy and reduced computational cost, the spatial derivatives in Eqs. \eqref{eq:n_eq} and \eqref{eq:p_eq} are computed in Fourier space by multiplying the field by $ik$ and $-k^2$, for the first and second derivatives, respectively, and subsequently transforming back to physical space. 
Nonlinear products (such as the pressure and damping contributions) are formed pointwise in $x$ space and returned to $k$ space by Fast Fourier Transform (FFT).

To control aliasing from these nonlinearities we apply the Orszag 2/3 truncation rule: after each right-hand-side evaluation we zero all modes with $|k|> (2/3)k_{\max}$, where $k_{\max}=\pi/\Delta x$ and $\Delta x=L/N_x$. When fields are multiplied, \addQ{the nonlinear math} generates artificial high-frequency waves that can wrap around and show up where they don't belong. By keeping only the lowest two-thirds of Fourier modes and zeroing the rest, we stop those fake signals from leaking into the range of interest. %we care about.

The semi-discrete system is studied using a \addQ{variable-order} BDF integrator implemented through the \emph{solve\_ivp} function with the BDF method, based on SciPy library. The solver used the relative and absolute tolerances $\mathrm{rtol}=10^{-4}$ and $\mathrm{atol}=10^{-7}$. These tolerance values were determined through numerical experiments as optimal: reducing them further increases runtime, while loosening them may introduce numerical artifacts. Therefore, when accuracy concerns arise, %it is recommended to 
we refine the spatial discretization $N_x$ and adjust the tolerance parameters accordingly.

\addQ{Only the time step adapts, in response to the local error estimator.}
The spatial discretization is fixed once a run begins: both the number of grid points $N_x$ and the domain length $L$ remain constant for the duration of the simulation. 

The domain is chosen so that the discrete wavenumber set $\{k_m=2\pi m/L\}$ contains the most unstable linear wavenumber $k^*$ predicted by the stability analysis and does not vary with time.
We first pick an integer %$M \in \mathbb{N}$ 
\addQ{$1<M<15$} representing the intended number of wavelengths in the box and set
\begin{equation} 
 L=\frac{2\pi M}{k^*}
\end{equation}
so that $k^*$ coincides exactly with the grid mode $k_M$.
We then select $N_x$ large enough that the de-aliased band retains not only $k^*$ but also its first few harmonics; in practice we enforce $M\le N_x/8$.
The box size and initial conditions is decided before the run and is not altered during simulation.

Simulations start from a spatially uniform drifting state, $n(x,0)=\bar n$ and $p(x,0)=m\bar nu_d$.
To seed pattern formation we add a small, deterministic superposition of cosine modes,
\addQ{[Why are there no sine modes?]}
\begin{align}
 n(x,0)&=\bar n + A_n\sum_{j\in\mathcal S}\cos\Big(\tfrac{2\pi j}{L}x\Big),
\\
 p(x,0)&=m\bar nu_d + A_p\sum_{j\in\mathcal S}\cos\Big(\tfrac{2\pi j}{L}x\Big),
\end{align}
where $\mathcal S$ is a finite set of low integers (for example $\{3,5,8,13,21\}$) and $A_n,A_p$ are small amplitudes (typically $0.03$). As shown on Fig. 2, regardless of initial conditions, the system
converges to the same spatial pattern. 

The density-dependent damping is implemented as Eq.\textcolor{red}{~5}. The pressure entering the momentum balance is Eq.\textcolor{red}{~9}. 
The electric field is uniform in space.
